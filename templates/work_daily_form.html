{% extends "layout.html" %}
{% block title %}ìƒˆ ì¼ì§€ ì‘ì„± - ERP System{% endblock %}
{% block content %}
<style>
    .task-table input[type="text"], .task-table textarea {
        width: 95%;
        padding: 5px;
        border: 1px solid #ccc;
        border-radius: 3px;
    }
    .task-table textarea {
        height: 40px;
        resize: vertical;
    }
    .task-table th, .task-table td {
        vertical-align: middle;
        text-align: center;
    }
</style>

<form action="{{ url_for('add_daily_log') }}" method="post">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <h2>ğŸ“… ìƒˆ ì¼ì§€ ì‘ì„±</h2>
        <div>
            <a href="{{ url_for('work_daily') }}" style="text-decoration: none; color: #555; margin-right: 15px;">ì·¨ì†Œ</a>
            <button type="submit">ğŸ’¾ ì¼ì§€ ì €ì¥</button>
        </div>
    </div>

    <div class="form-box" style="margin-top: 20px;">
        <label for="work_date"><strong>ì—…ë¬´ ë‚ ì§œ</strong></label>
        <input type="date" id="work_date" name="work_date" required>
    </div>

    <table class="task-table" style="margin-top: 20px;">
        <thead>
            <tr>
                <th style="width: 10%;">ì˜¤ì „/ì˜¤í›„</th>
                <th style="width: 15%;">ì—…ë¬´êµ¬ë¶„</th>
                <th style="width: 25%;">ì—…ë¬´ì²˜ë¦¬ë‚´ìš©</th>
                <th style="width: 20%;">ì—…ë¬´ì²˜ë¦¬ê²°ê³¼</th>
                <th style="width: 15%;">í–¥í›„ì¼ì •</th>
                <th style="width: 10%;">ë¹„ê³ </th>
                <th style="width: 5%;">ì‚­ì œ</th>
            </tr>
        </thead>
        <tbody id="task-body">
            <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ í–‰ì´ ì¶”ê°€ë  ë¶€ë¶„ -->
        </tbody>
    </table>

    <button type="button" id="add-row-btn" style="margin-top: 15px;">+ í–‰ ì¶”ê°€</button>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const tableBody = document.getElementById('task-body');
        const addRowBtn = document.getElementById('add-row-btn');
        let rowCount = 0;

        function addRow() {
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td>
                    <input type="checkbox" name="work_time_am_${rowCount}" value="ì˜¤ì „"> ì˜¤ì „<br>
                    <input type="checkbox" name="work_time_pm_${rowCount}" value="ì˜¤í›„"> ì˜¤í›„
                </td>
                <td><input type="text" name="task_type_${rowCount}"></td>
                <td><textarea name="task_details_${rowCount}"></textarea></td>
                <td><input type="text" name="task_result_${rowCount}"></td>
                <td><input type="text" name="future_plan_${rowCount}"></td>
                <td><input type="text" name="notes_${rowCount}"></td>
                <td><button type="button" class="delete-row-btn">ì‚­ì œ</button></td>
            `;
            tableBody.appendChild(newRow);
            rowCount++;
        }

        tableBody.addEventListener('click', function (e) {
            if (e.target && e.target.classList.contains('delete-row-btn')) {
                e.target.closest('tr').remove();
            }
        });

        addRowBtn.addEventListener('click', addRow);

        // ê¸°ë³¸ìœ¼ë¡œ 3í–‰ ì¶”ê°€
        for (let i = 0; i < 3; i++) {
            addRow();
        }
        
        // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
        document.getElementById('work_date').valueAsDate = new Date();
    });
</script>
{% endblock %}
